# Monit

Apache/Nginxのアクセスログをリアルタイムで監視し、レスポンスタイムを分析するツールです。

## 機能

- アクセスログのリアルタイム監視
- レスポンスタイムの色分け表示
  - 🟢 速い（500ms未満）
  - 🟡 普通（500ms〜1000ms）
  - 🔴 遅い（1000ms以上）
- 30秒ごとに統計情報を自動表示
  - 全体の統計（リクエスト数、平均・最大・最小レスポンスタイム、遅延リクエスト数）
  - パス別統計（Top 10）

## 必要要件

- Go 1.16以上

## セットアップ

1. リポジトリのクローン
```bash
git clone https://github.com/goto0823/Monit.git
cd Monit
```

2. 依存関係のインストール
```bash
go mod download
```

3. 環境変数の設定

`.env.example`をコピーして`.env`ファイルを作成します：
```bash
cp .env.example .env
```

`.env`ファイルを編集してログファイルのパスを設定：
```
LOGDIR=/var/log/apache2/access.log
```

または
```
LOGDIR=/var/log/httpd/access.log
```

## ビルド

```bash
go build -o getData
```

## 実行

```bash
./getData
```

プログラムを停止するには`Ctrl+C`を押してください。

## 対応するログフォーマット

以下の形式のアクセスログに対応しています：

```
IP ポート - - [日時] "メソッド パス プロトコル" ステータス バイト数 "Referer" "User-Agent" レスポンスタイム(μs)
```

例：
```
192.168.1.1 8080 - - [09/Nov/2025:12:34:56 +0900] "GET /api/users HTTP/1.1" 200 1234 "-" "Mozilla/5.0" 12345
```

## 出力例

```
ログファイルを監視中... (Ctrl+C で終了)
==========================================
[12:34:56] 🟢 GET 192.168.1.1:8080 /api/users - Status: 200, Response: 12.35 ms (12345 μs)
[12:34:57] 🟡 POST 192.168.1.2:8080 /api/login - Status: 200, Response: 678.90 ms (678900 μs)
[12:34:58] 🔴 GET 192.168.1.3:8080 /api/heavy - Status: 200, Response: 1234.56 ms (1234560 μs)

========== 統計情報 (直近30秒) ==========
全体: リクエスト数=150, 平均=234.56 ms, 最大=1234.56 ms, 最小=12.34 ms, 遅延リクエスト=5

パス別統計 (Top 10):
  /api/users: 回数=50, 平均=123.45 ms, 最大=456.78 ms, 最小=12.34 ms
  /api/login: 回数=30, 平均=234.56 ms, 最大=678.90 ms, 最小=100.12 ms
  /api/heavy: 回数=20, 平均=890.12 ms, 最大=1234.56 ms, 最小=567.89 ms
==========================================
```

## ライセンス

MIT
